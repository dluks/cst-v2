schema: '2.0'
stages:
  standardize_other_products:
    cmd: python src/data/standardize_other_products.py
    deps:
    - path: data/raw/other-trait-maps
      hash: md5
      md5: 848dac77f0897cf7e58f41a196fe1d68.dir
      size: 32055985074
      nfiles: 1510
    - path: src/data/standardize_other_products.py
      hash: md5
      md5: 2e4c967cc9dda5883850576253521e00
      size: 4665
    outs:
    - path: data/interim/other_trait_maps
      hash: md5
      md5: 4ce80d8ff95ecdcbad3f7738ed93d461.dir
      size: 1183362520
      nfiles: 63
  build_container:
    cmd: stages/build_container.sh singularity cit-sci-traits latest cit-sci-traits.def
      cit-sci-traits.sif
    deps:
    - path: README.md
      hash: md5
      md5: c255f86c149ea407ee916b3eb75be456
      size: 9726
    - path: cit-sci-traits.def
      hash: md5
      md5: a9ece716692785bb77a429cccfd774d0
      size: 1465
    - path: poetry.lock
      hash: md5
      md5: 8f7cfac13e06acaf604d74b7951ca402
      size: 667727
    - path: pyproject.toml
      hash: md5
      md5: abb62da99ab8238dbfd94f6814da0866
      size: 1732
    - path: stages/build_container.sh
      hash: md5
      md5: 52742d9dcb076bd83a511a755757a5f3
      size: 917
      isexec: true
    params:
      params.yaml:
        container:
          type: singularity
          name: cit-sci-traits
          docker_tag: latest
          def: cit-sci-traits.def
          image: cit-sci-traits.sif
    outs:
    - path: cit-sci-traits.sif
      hash: md5
      md5: 2168f356be5b96afb1549bb3bec41a15
      size: 20662411264
      isexec: true
  get_TRY_mean_traits:
    cmd: python src/data/build_try_traits.py
    deps:
    - path: data/raw/TRY_6_gapfilled_for_distribution/TRY6_gapfilled_for_distribution.zip
      hash: md5
      md5: f2cc4a7dd419bed117f42e62780b16e8
      size: 307941318
    - path: src/data/build_try_traits.py
      hash: md5
      md5: c918e38e1c0d49fbac88a6308042cdc2
      size: 5918
    params:
      params.yaml:
        trydb:
          raw:
            dir: TRY_6_gapfilled_for_distribution
            zip: TRY6_gapfilled_for_distribution.zip
            zipfile_csv: TRY6_gapfilled_for_distribution/TRY6_gapfilled_filtered_2.csv.zip
            pfts: try_pft_v2.parquet
          interim:
            dir: try
            quantile_range:
            transform:
            already_norm:
            filtered: traits.parquet
            transformer_fn: no_transform.pkl
    outs:
    - path: data/interim/try/no_transform.pkl
      hash: md5
      md5: 7d1e55650014e21b4568ed3e3d1fc531
      size: 4
    - path: data/interim/try/traits.parquet
      hash: md5
      md5: 2aef32b0d5ab309c849c5f88de2a3ce6
      size: 10422220
  extract_splot:
    cmd: stages/extract_splot.sh singularity cit-sci-traits latest cit-sci-traits.sif
      "poetry run python src/data/extract_splot.py"
    deps:
    - path: data/raw/sPlotOpen_v76
      hash: md5
      md5: c06b62279da8afd1048f42572852ecc6.dir
      size: 526410695
      nfiles: 12
    - path: src/data/extract_splot.py
      hash: md5
      md5: 81870e467b6fabf2fab2c844f0cc87bb
      size: 4939
    params:
      params.yaml:
        datasets.Y.splot: sPlotOpen_v76
        splot.interim.dir: splot
    outs:
    - path: data/interim/splot/extracted
      hash: md5
      md5: a72673c4a61c5107c5af271a945ecfc1.dir
      size: 47948903
      nfiles: 3
